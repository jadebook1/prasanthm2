#!/bin/bash

# Function to execute a SQL query and store the result in a variable
execute_query() {
  local query="$1"
  local result=$(db2 -x "$query")
  echo "$result"
}

# Main script logic
main() {
  # Read the CSV file and process the data
  while IFS=, read -r table1 key_column table2 reference_column
  do
    echo "Joining $table2 on $table1.$key_column = $table2.$reference_column"
    
    # Generate the dynamic SQL query to create the view
    join_query="JOIN $table2 ON $table1.$key_column = $table2.$reference_column"

    # Execute the join query
    execute_query "$join_query"

    echo "Join executed"
    echo "---"

  done < your_csv_file.csv
}

# Execute the main script
main
